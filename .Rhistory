plot(year,julian)
plot(year,logElevation)
plot(year,elevation)
invJulian<-((-1)/(julian))
invElevation<-((-1)/(elevation))
model7<-lm(invElevation~year)
model8<-lm(invJulian~year)
summary(model7)
summary(model8)
hist(resid(model7))
shapiro.test(resid(model7))
hist(resid(model8))
shapiro.test(resid(model8))
invsqJulian<-((-1)/((julian)^2))
invsqElevation<-((-1)/((elevation)^2))
model9<-lm(invsqElevation~year)
model10<-lm(invsqJulian~year)
summary(model9)
summary(model10)
hist(resid(model9))
shapiro.test(resid(model9))
hist(resid(model10))
shapiro.test(resid(model10))
library(car)
leveneTest(julian~year)
leveneTest(elevation~year)
bartlett.test(julian~year)
bartlett.test(elevation~year)
summary(model1)
hist(resid(model1))# Look for normality
qqnorm(resid(model1)); qqline(resid(model1))
shapiro.test(resid(model1))
stack(resid(model1))
library(readr)
BOPE_605 <- read_csv("Documents/Bio605/Project/BOPE_605.csv")
View(BOPE_605)
attach(BOPE_605)
class(year)
class(elevation)
class(julian)
plot(julian~year, xlab=("Year"), ylab="Julian Date", main="Phenology of B. perennans")
abline(lm(julian~year), col="red")
plot(elevation~year, xlab=("Year"), ylab="Elevation (in meters)", main="Elevation observations of B. perennans")
abline(lm(elevation~year), col="red")
model1<-lm(elevation~year)
summary(model1)
model2<-lm(julian~year)
summary(model2)
sqrtJulian<-sqrt(julian)
sqrtElevation<-sqrt(elevation)
model3<-lm(sqrtElevation~year)
model4<-lm(sqrtJulian~year)
summary(model3)
summary(model4)
hist(resid(model3))# look for normality
shapiro.test(resid(model3))
hist(resid(model4))# look for normality
shapiro.test(resid(model4))
logJulian<-log(julian)
logElevation<-log(elevation)
model5<-lm(logElevation~year)
model6<-lm(logJulian~year)
summary(model5)
summary(model6)
hist(resid(model5))# look for normality
shapiro.test(resid(model5))
hist(resid(model6))# look for normality
shapiro.test(resid(model6))
plot(year,logJulian)
plot(year,julian)
#model 6 normal???
vartest6<-stack(split(resid(model6),ceiling(seq_along(resid))/149))
detach(BOPE_605)
attach(vartest6)
bartlett.test(values~ind)
#model 6 normal???
vartest6<-stack(split(resid(model6),ceiling(seq_along(resid(model6))/149)))
attach(vartest6)
bartlett.test(values~ind)
invJulian<-((-1)/(julian))
invElevation<-((-1)/(elevation))
model7<-lm(invElevation~year)
model8<-lm(invJulian~year)
invJulian<-((-1)/(julian))
attach(BOPE_605)
library(readr)
BOPE_605 <- read_csv("Documents/Bio605/Project/BOPE_605.csv")
View(BOPE_605)
attach(BOPE_605)
model1<-lm(elevation~year)
summary(model1)hist(resid(model1))# Look for normality
model2<-lm(julian~year)
sqrtJulian<-sqrt(julian)
sqrtElevation<-sqrt(elevation)
model3<-lm(sqrtElevation~year)
model4<-lm(sqrtJulian~year)
logJulian<-log(julian)
logElevation<-log(elevation)
model5<-lm(logElevation~year)
model6<-lm(logJulian~year)
invJulian<-((-1)/(julian))
invElevation<-((-1)/(elevation))
model7<-lm(invElevation~year)
model8<-lm(invJulian~year)
invsqJulian<-((-1)/((julian)^2))
invsqElevation<-((-1)/((elevation)^2))
model9<-lm(invsqElevation~year)
model10<-lm(invsqJulian~year)
arcsinJulian<-arcsin(sqrt(julian))
arcsinJulian<-asin(sqrt(julian))
arcsinElevation<-asin(sqrt(elevation))
model11<-lm(arcsinElevation~year)
model12<-lm(arcsinJulian~year)
AIC(model1)
BIC(model1)
AIC(model2)
BIC(model2)
AIC(model3)
BIC(model3)
AIC(model4)
BIC(model4)
AIC(model5)
BIC(model5)
AIC(model6)
BIC(model6)
AIC(model7)
BIC(model7)
AIC(model8)
BIC(model8)
AIC(model9)
BIC(model9)
AIC(model10)
BIC(model10)
plot(resid(model6))
plot(resid(model6));abline(lm(resid(model6)))
plot(resid(model6));abline(lm(resid(model6)))
plot(resid(model6))
abline(lm(resid(model6)))
abline((resid(model6)))
plot(resid(model6))
abline((resid(model6)))
length(model6)
View(model6)
596/2
#model 6 normal???
vartest6<-stack(split(resid(model6),ceiling(seq_along(resid(model6))/298)))
attach(vartest6)
bartlett.test(values~ind)
vartest2<-stack(split(resid(model6),ceiling(seq_along(resid(model2))/298)))
attach(vartest2)
bartlett.test(values~ind)
attach(vartest6)
bartlett.test(values~ind)
logJulian<-log(julian)
E
model5<-lm(logElevation~year)
summary(model5)
hist(resid(model5))# look for normality
shapiro.test(resid(model5))
vartest5<-stack(split(resid(model5),ceiling(seq_along(resid(model5))/298)))
attach(vartest5)
bartlett.test(values~ind)
qqnorm(resid(model5)); qqline(resid(model5))
shapiro.test(resid(model5))
library(readr)
BOAR_605 <- read_csv("Downloads/BOAR_605.csv")
View(BOAR_605)
detach(BOPE_605)
attach(BOAR_605)
class(year)
class(elevation)
class(julian)
plot(julian~year, xlab=("Year"), ylab="Julian Date", main="Phenology of B. arcuata")
abline(lm(julian~year), col="red")
plot(elevation~year, xlab=("Year"), ylab="Elevation (in meters)", main="Elevation observations of B. arcuata")
abline(lm(elevation~year), col="red")
model1<-lm(elevation~year)
summary(model1)
hist(resid(model1))# Look for normality
qqnorm(resid(model1)); qqline(resid(model1))
shapiro.test(resid(model1))
stack(resid(model1))
vartest1<-stack(split(resid(model1),ceiling(seq_along(resid(model1))/250)))
vartest1<-stack(split(resid(model1),ceiling(seq_along(resid(model1))/250)))
detach(BOAR_605)
attach(vartest1)
ind
values
bartlett.test(values~ind)
AIC(model1)
BIC(model1)
model2<-lm(julian~year)
summary(model2)
detach(vartest1)
attach(BOAR_605)
model2<-lm(julian~year)
summary(model2)
hist(resid(model2))
qqnorm(resid(model2)); qqline(resid(model2))
shapiro.test(resid(model2))
stack(resid(model2))
vartest2<-stack(split(resid(model2),ceiling(seq_along(resid(model2))/250)))
attach(vartest2)
bartlett.test(values~ind)
detach(vartest2)
attach(BOAR_605)
logJulian<-log(julian)
logElevation<-log(elevation)
model5<-lm(logElevation~year)
model6<-lm(logJulian~year)
model5<-lm(logElevation~year)
m
m
summary(model6)
hist(resid(model5))# look for normality
logJulian<-log(julian)
logElevation<-log(elevation)
model5<-lm(logElevation~year)
model6<-lm(logJulian~year)
hist(resid(model6))# look for normality
shapiro.test(resid(model6))
vartest6<-stack(split(resid(model6),ceiling(seq_along(resid(model6))/250)))
detach(BOAR_605)
attach(vartest6)
bartlett.test(values~ind)
detach(BOAR_605)
#correlation
cor.test(julian,year,method= "spearman")
#Correlation
#Load the TempNitrate data set
#Install the package Rmisc.  I have placed this on the Blackboard site#
install.packages("Rmisc")
library (Rmisc)
cor.test (elevation,julian)
detach(BOAR_605)
attach(BOPE_605)
cor.test (elevation,julian)
cor.test(elevation, julian,method= "spearman")
shapiro.test(elevation)
shapiro.test(julian)
cor.test(julian, elevation,method= "spearman")
cor.test(year, elevation,method= "spearman")
cor.test(year, julian,method= "spearman")
View(BOPE_605)
View(BOAR_605)
View(BOPE_605)
library(readr)
BOPE_605 <- read_csv("Documents/Bio605/Project/BOPE_605.csv")
View(BOPE_605)
attach(BOPE_605)
View(BOPE_605)
shapiro.test(julian[period=="Early"])
shapiro.test(julian[period=="Late"])
wilcox.test((julian[period=="Early"]),(julian[period=="Late"]))
boxplot(julian~period, xlab="Time period", ylab="day of year", main="B. perennans phenology")
boxplot(elevation~period, xlab="Time period", ylab="day of year", main="B. perennans elevation")
shapiro.test(elevation[period=="Early"])
shapiro.test(elevation[period=="Late"])
wilcox.test((elevation[period=="Early"]),(elevation[period=="Late"]))
modelAE<-aov(elevation~year)
modelAJ<-aov(julian~year)
summary(modelAE)
summary(modelAJ)
modelAE<-aov(elevation~decade)
summary(modelAJ)
summary(modelAE)
shapiro.test(elevation[decade=="2020"]) #normal
modelAE<-aov(elevation~decade)
modelAJ<-aov(julian~decade)
summary(modelAE)
model3<-lm(elevation~year)
summary(model3)
library(readr)
ex3_q5 <- read_csv("Documents/Bio605/Exam 3/ex3_q5.csv")
View(ex3_q5)
library(readr)
ex3_q5 <- read_csv("Documents/Bio605/Exam 3/ex3_q5.csv")
View(ex3_q5)
attach(ex3_q5)
plot(ex3_q5)
modelq5<-lm(Shoulder~Paw)
summary(modelq5)
plot(Shoulder~Paw)
logShoulder<-log(Shoulder)
plot(logShoulder~Paw)
sqrtShoulder<-sqrt(Shoulder)
plot(sqrtShoulder~Paw)
library(readr)
ex3_q5 <- read_csv("Documents/Bio605/Exam 3/ex3_q5.csv")
View(ex3_q5)
library(readr)
ex3_q6 <- read_csv("Documents/Bio605/Exam 3/ex3_q6.csv")
View(ex3_q6)
View(ex3_q6)
library(readr)
ex3_q6 <- read_csv("Documents/Bio605/Exam 3/ex3_q6.csv")
View(ex3_q6)
View(ex3_q6)
detach(ex3_q5)
#Q6
attach(ex3_q6)
View(ex3_q6)
#Q6
attach(ex3_q6)
par(mfrow=c(2,2))
qqnorm(Whelk[Bench==1]);qqline(Whelk[Bench==1])
qqnorm(Whelk[Bench==2]);qqline(Whelk[Bench==2])
qqnorm(Whelk[Bench==3]);qqline(Whelk[Bench==3])
qqnorm(Whelk[Bench==4]);qqline(Whelk[Bench==4])
par(mfrow=c(1,1))
shapiro.test(Whelk[Bench==1])
shapiro.test(Whelk[Bench==2])
shapiro.test(Whelk[Bench==3])
shapiro.test(Whelk[Bench==4])
bartlett.test(Whelk~Bench)
sqrtWhelk<-sqrt(Whelk)
bartlett.test(transWhelk~Bench)
bartlett.test(sqrtWhelk~Bench)
logWhelk<-log(Whelk)
bartlett.test(logWhelk~Bench)
shapiro.test(logWhelk[Bench=="1"])
shapiro.test(logWhelk[Bench=="2"])
shapiro.test(logWhelk[Bench=="3"])
shapiro.test(logWhelk[Bench=="4"])
sqrtWhelk<-sqrt(Whelk)
shapiro.test(sqrtWhelk[Bench=="1"])
shapiro.test(sqrtWhelk[Bench=="2"])
shapiro.test(sqrtWhelk[Bench=="3"])
shapiro.test(sqrtWhelk[Bench=="4"])
bartlett.test(sqrtWhelk~Bench)
logWhelk<-log(Whelk)
shapiro.test(logWhelk[Bench=="1"])
shapiro.test(logWhelk[Bench=="2"])
shapiro.test(logWhelk[Bench=="3"])
shapiro.test(logWhelk[Bench=="4"])
bartlett.test(logWhelk~Bench)
model6sqrt<-aov(sqrtWhelk~Bench)
summary(model6sqrt)
model6log<-aov(logWhelk~Bench)
summary(modelq6)
summary(modelq6log)
model6log<-aov(logWhelk~Bench)
summary(modelq6log)
summary(model6log)
detach(ex3_q6)
library(readr)
ex3_q4 <- read_csv("Documents/Bio605/Exam 3/ex3_q4.csv")
View(ex3_q4)
View(ex3_q4)
#4
attach(ex3_q4)
library("picante")
plot(ex3_q4)
cor.table(ex3_q4,cor.method="pearson")
,cor.table(ex3_q4,cor.method="spearman")
cor.table(ex3_q4,cor.method="spearman")
detach(ex3_q4)
library(readr)
ex3_q3 <- read_csv("Documents/Bio605/Exam 3/ex3_q3.csv")
View(ex3_q3)
#3
attach(ex3_q3)
plot(ex3_q3)
cor.table(ex3_q3,cor.method="pearson")
cor.table(ex3_q3,cor.method="spearman")
detach(ex3_q3)
#4
attach(ex3_q4)
modelq3<-lm(worms~.,data=ex3_q4)
anova(modelq3)
summary(modelq3)
library("car")
Anova(modelq3,Type="II")
step(modelq3,direction="backward")
anova(step(modelq3,direction="backward"))
full<-lm(worms~temperature+depth+pH+moisture+ants+grubs+grainsize+roots)
reduced<-lm(temperature+pH+ants+grainsize)
reduced<-lm(worms~temperature+pH+ants+grainsize)
anova(full,reduced)
summary(reduced)
Anova(reduced,Type="II")
round(cor.table(ex3_q4[,c(2,4,6,8)])$r,2)
round(cor.table(ex3_q4[,c(2,4,6,8)])$P,2)
round(cor.table(ex3_q4[,c(2,4,6,8)])$P,3)
(cor.table(ex3_q4[,c(2,4,6,8)])$P,3))
cor.table(ex3_q4[,c(2,4,6,8)])$P
library(leaps)
best.subset<-regsubsets(worms~.,ex3_q4,nvmax=8)
best.subset.summary<-summary(best.subset)
best.subset.summary$outmat
best.subset.summary
best.subset.by.bic<-which.min(best.subset.summary$bic)
best.subset.by.bic
best.subset<-regsubsets(worms~.,ex3_q4,nvmax=5)
best.subset.by.bic<-which.min(best.subset.summary$bic)
best.subset.by.bic
best.subset.summary<-summary(best.subset)
best.subset.summary$outmat
modelBIC<-lm(worms~temperature+pH+ants)
anova(modelBIC)
summary(modelBIC)
install.packages(adegenet)
install.packages("adegenet")
install.packages("poppr")
install.packages("PopGenome")
?PopGenome
??PopGenome
knitr::opts_chunk$set(echo = TRUE)
install.packages("Fragman")
library(Fragman)
help("Fragman")
library(Fragman)
library(vegan)
library(FactoMineR)
library(ggplot2)
library(ggfortify)
library(tidyverse)
library(factoextra)
library(gridExtra)
library(car)
library(leaps)
library(picante)
library(hrbrthemes)
library(plotly)
library(tibble)
library(forcats)
library(scales)
library(nlme)
library(lme4)
library(cluster)
library(modEvA)
library(poppr)
library(AICcmodavg)
library(effects)
#setwd("~/Desktop/StressExperiments")
#setwd("C:/Users/Daniel/Desktop/BoecheraStress-main")
setwd("~/Documents/GitHub/BoecheraStress")
stress <- read.csv("jrpam_all.csv")
recovery <- read.csv("jrpam_5day.csv")
climate <- read.csv("boechera_climate_data.csv")
climate$PopID <- as.factor(climate$PopID)
stress$PopID <- as.factor(stress$PopID)
recovery$PopID <- as.factor(recovery$PopID)
colnames(stress) <- c('Individual','PopID','Region','Species',
'Heat.Temp','Cotyledon.vs.TL',
'count','Date.Stress','Time.Stress','Fo.prime','No.',
'F','Fm.','Temp','YII','Fo','Fm','Fv.Fm')
colnames(recovery) <- c('Individual','PopID','Region','Species','Heat.Temp',
'Cotyledon.vs.TL', 'count','Date.Stress','Time.Stress',
'Fo.prime','No.', 'F','Fm.','Temp','YII','Fo','Fm','Fv.Fm')
stress.clim <- left_join(stress, climate, by=c("Individual","Region","PopID","Species"))
colnames(stress.clim) <- c('Individual','PopID','Region','Species','Heat.Temp','Cotyledon.vs.TL','count','Date.Stress','Time.Stress','Fo.prime','No.','F','Fm.','Temp','YII','Fo','Fm','Fv.Fm','Latitude','Longitude','Elevation','Date.Found','tmean','tmax','tmin','PPT','tdmean','vpdmax','vpdmin','aspect','solclear','soltrans') #Renaming columns for legibility
recovery.clim <- left_join(recovery, climate, by=c("Individual","Region","PopID","Species"))
colnames(recovery.clim) <- c('Individual','PopID','Region','Species','Heat.Temp','Cotyledon.vs.TL','count','Date.Stress','Time.Stress','Fo.prime','No.','F','Fm.','Temp','YII','Fo','Fm','Fv.Fm','Latitude','Longitude','Elevation','Date.Found','tmean','tmax','tmin','PPT','tdmean','vpdmax','vpdmin','aspect','solclear','soltrans')
recovery.clim <- recovery.clim %>%
filter(Heat.Temp == "44")
stress.clim <- stress.clim %>%
filter(Heat.Temp == "44")
recovery.clim.ca <- recovery.clim %>%
filter(Species == "arcuata" | Species == "retrofracta" | Species == "californica")
stress.clim.ca <- stress.clim %>%
filter(Species == "arcuata" | Species == "retrofracta" | Species == "californica")
stress.clim.ca <- stress.clim.ca %>%
filter(Cotyledon.vs.TL=="True Leaf")
recovery.clim.ca <- recovery.clim.ca %>%
filter(Cotyledon.vs.TL=="True Leaf")
recovery.clim.ca.var <- aggregate(YII ~ Individual + count,
data=recovery.clim.ca,
function(x) {
c(avg=var(x))
})
colnames(recovery.clim.ca.var) <- c('Individual','count','YII.var')
recovery.clim.ca.2 <- left_join(recovery.clim.ca.var, recovery.clim.ca, by=c('Individual','count'))
recovery.clim.ca.3 <- recovery.clim.ca.2[!duplicated(recovery.clim.ca.2$count), ]
head(recovery.clim.ca.2)
recovery.clim.ca.2 <- recovery.clim.ca.2[,-c(9,10,11,12,23,31)]
recovery.clim.ca.mean <- aggregate(YII ~ Individual + count,
data=recovery.clim.ca,
function(x) {
c(avg=mean(x))
})
colnames(recovery.clim.ca.mean) <- c('Individual','count','YII.mean')
recovery.clim.ca.2 <- left_join(recovery.clim.ca.mean, recovery.clim.ca.2, by=c('Individual','count'))
recovery.clim.ca.3 <- recovery.clim.ca.2[!duplicated(recovery.clim.ca.2$count), ]
recovery.clim.ca.3$Individual <- as.factor(recovery.clim.ca.3$Individual)
head(recovery.clim.ca.3)
recovery.clim.ca.2$Individual <- as.factor(recovery.clim.ca.2$Individual)
#write.csv(recovery.clim.ca.3,file ="Recovery.clim.ca.3.csv", row.names=FALSE)
#For the initial stress group
stress.clim.ca.var <- aggregate(YII ~ Individual + count,
data=stress.clim.ca,
function(x) {
c(avg=var(x))
})
colnames(stress.clim.ca.var) <- c('Individual','count','YII.var')
stress.clim.ca.2 <- left_join(stress.clim.ca.var, stress.clim.ca, by=c('Individual','count'))
stress.clim.ca.3 <- stress.clim.ca.2[!duplicated(stress.clim.ca.2$count), ]
head(stress.clim.ca.2)
stress.clim.ca.2 <- stress.clim.ca.2[,-c(9,10,11,12,23,31)]
stress.clim.ca.mean <- aggregate(YII ~ Individual + count,
data=stress.clim.ca,
function(x) {
c(avg=mean(x))
})
colnames(stress.clim.ca.mean) <- c('Individual','count','YII.mean')
stress.clim.ca.2 <- left_join(stress.clim.ca.mean, stress.clim.ca.2, by=c('Individual','count'))
stress.clim.ca.3 <- stress.clim.ca.2[!duplicated(stress.clim.ca.2$count), ]
stress.clim.ca.2$Individual <- as.factor(stress.clim.ca.2$Individual)
head(stress.clim.ca.3)
nest_species <- aov(recovery.clim.ca.3$YII.mean ~ recovery.clim.ca.3$Species)
summary(nest_species)
TukeyHSD(nest_species)
