'Cotyledon.vs.TL', 'count','Date.Stress','Time.Stress',
'Fo.prime','No.', 'F','Fm.','Temp','YII','Fo','Fm','Fv.Fm')
stress.clim <- left_join(stress, climate, by=c("Individual","Region","PopID","Species"))
colnames(stress.clim) <- c('Individual','PopID','Region','Species','Heat.Temp','Cotyledon.vs.TL','count','Date.Stress','Time.Stress','Fo.prime','No.','F','Fm.','Temp','YII','Fo','Fm','Fv.Fm','Latitude','Longitude','Elevation','Date.Found','tmean','tmax','tmin','PPT','tdmean','vpdmax','vpdmin','aspect','solclear','soltrans') #Renaming columns for legibility
recovery.clim <- left_join(recovery, climate, by=c("Individual","Region","PopID","Species"))
colnames(recovery.clim) <- c('Individual','PopID','Region','Species','Heat.Temp','Cotyledon.vs.TL','count','Date.Stress','Time.Stress','Fo.prime','No.','F','Fm.','Temp','YII','Fo','Fm','Fv.Fm','Latitude','Longitude','Elevation','Date.Found','tmean','tmax','tmin','PPT','tdmean','vpdmax','vpdmin','aspect','solclear','soltrans')
stress.clim.ca <- stress.clim %>%
filter(Species == "californica")
recovery.clim.ca <- recovery.clim %>%
filter(Species == "californica")
recovery.clim.ca.var <- aggregate(YII ~ Individual + count,
data=recovery.clim.ca,
function(x) {
c(avg=var(x))
})
colnames(recovery.clim.ca.var) <- c('Individual','count','YII.var')
recovery.clim.ca.2 <- left_join(recovery.clim.ca.var, recovery.clim.ca, by=c('Individual','count'))
recovery.clim.ca.3 <- recovery.clim.ca.2[!duplicated(recovery.clim.ca.2$count), ]
head(recovery.clim.ca.2)
recovery.clim.ca.2 <- recovery.clim.ca.2[,-c(9,10,11,12,23,31)]
recovery.clim.ca.mean <- aggregate(YII ~ Individual + count,
data=recovery.clim.ca,
function(x) {
c(avg=mean(x))
})
colnames(recovery.clim.ca.mean) <- c('Individual','count','YII.mean')
recovery.clim.ca.2 <- left_join(recovery.clim.ca.mean, recovery.clim.ca.2, by=c('Individual','count'))
recovery.clim.ca.3 <- recovery.clim.ca.2[!duplicated(recovery.clim.ca.2$count), ]
recovery.clim.ca.3$Individual <- as.factor(recovery.clim.ca.3$Individual)
head(recovery.clim.ca.3)
recovery.clim.ca.2$Individual <- as.factor(recovery.clim.ca.2$Individual)
#write.csv(recovery.clim.ca.3,file ="Recovery.clim.ca.3.csv", row.names=FALSE)
stress.clim.ca.var <- aggregate(YII ~ Individual + count,
data=stress.clim.ca,
function(x) {
c(avg=var(x))
})
colnames(stress.clim.ca.var) <- c('Individual','count','YII.var')
stress.clim.ca.2 <- left_join(stress.clim.ca.var, stress.clim.ca, by=c('Individual','count'))
stress.clim.ca.3 <- stress.clim.ca.2[!duplicated(stress.clim.ca.2$count), ]
head(stress.clim.ca.2)
stress.clim.ca.2 <- stress.clim.ca.2[,-c(9,10,11,12,23,31)]
stress.clim.ca.mean <- aggregate(YII ~ Individual + count,
data=stress.clim.ca,
function(x) {
c(avg=mean(x))
})
colnames(stress.clim.ca.mean) <- c('Individual','count','YII.mean')
stress.clim.ca.2 <- left_join(stress.clim.ca.mean, stress.clim.ca.2, by=c('Individual','count'))
stress.clim.ca.3 <- stress.clim.ca.2[!duplicated(stress.clim.ca.2$count), ]
stress.clim.ca.2$Individual <- as.factor(stress.clim.ca.2$Individual)
head(stress.clim.ca.3)
adegenetTutorial("snapclust")
library(adegenet)
data(dapcIllus)
sapply(dapcIllus, nPop)
dapcIllus
a.clust <- snapclust(dapcIllus$a, k = 6)
class(a.clust)
names(a.clust)
head(a.clust$group, 12)
length(a.clust$group)
dim(a.clust$proba)
head(a.clust$proba)
a.tab <- table(pop(dapcIllus$a), a.clust$group)
a.tab
class(a.tab)
gendf1<- read.csv("msatdf_trip_missingmarkers.csv")
rownames(gendf1) <- gendf1[,1]; gendf1 <- gendf1[,-c(1)]
gendf2 <- t(gendf1)
obj1 <- df2genind(gendf1, sep=",", ncode=3, NA.char=0, ploidy=3, type='codom')
obj1
AICc(obj1, 3, pop.ini = "ward",
max.iter = 100,
n.start = 10,
n.start.kmeans = 50,
hybrids = FALSE,
dim.ini = 100,
hybrid.coef = NULL,
)
a.clust <- snapclust(obj1, k = 2)
M1a <- lm(Stress ~ ClimDist, data=dist.df2)
M1b <-lm(Stress ~ GeogDist, data=dist.df2)
M1c <-lm(Stress ~ GenDist, data=dist.df2)
AIC(M1a);AIC(M1b);AIC(M1c)
BIC(M1a);BIC(M1b);BIC(M1c)
summary(M1c)
a <- lm(Bruvo ~ ClimDist, data=dist.df)
a2 <-lm(Bruvo ~ GeogDist, data=dist.df)
AICc(a);AIC(a2);AIC(a3);AIC(a4)
a3 <-lm(ClimDist ~ GeogDist, data=dist.df)
a4 <- lm(Bruvo ~ ClimDist + GeogDist, data=dist.df)
AICc(a);AIC(a2);AIC(a3);AIC(a4)
AICc(a);AIC(a2);AIC(a3);AIC(a4)
AIC(a);AIC(a2);AIC(a3);AIC(a4)
M1a <-glm(Stress ~ ClimDist, data=dist.df2)
M1b <-glm(Stress ~ GeogDist, data=dist.df2)
M1c <-glm(Stress ~ GenDist, data=dist.df2)
AIC(M1a);AIC(M1b);AIC(M1c)
Y2 <- data.frame(recovery.clim.ca$Individual, recovery.clim.ca$PopID, recovery.clim.ca$YII)
names(Y2) <- c("Individual", "PopID","YII")
Y2$Individual <- as.factor(Y2$Individual)
#Y2a <- left_join(clusts, Y2, by=c("Individual","PopID"))
Y2b <- aggregate(YII ~ PopID,
data=Y2,
function(x) {
c(avg=var(x))
})
Y2b
Y2d <- dist(Y2, method="euclidean")
dist.df2 <- data.frame( GenDist=ngpop2[lower.tri(ngpop2)], ClimDist=euclid.clim.subset[ lower.tri(euclid.clim.subset)], GeogDist = km.subset.d[lower.tri(km.subset.d)], Stress = Y2d.stress[lower.tri(Y2d.stress)])
M1a <- lm(Stress ~ ClimDist, data=dist.df2)
M1b <-lm(Stress ~ GeogDist, data=dist.df2)
M1c <-lm(Stress ~ GenDist, data=dist.df2)
AIC(M1a);AIC(M1b);AIC(M1c)
BIC(M1a);BIC(M1b);BIC(M1c)
AIC(M1a)
AIC(M1b)
AIC(ln(-2317.8))
ln(-2317)
AIC(log(-2317.8))
install.packages('AICcmodavg')
cand.mods <- list("Climate" = M1a, "Geography" = M1b, "Genetic" = M1c)
selectionTable <- aictab(cand.set = cand.mods)
library(AICcmodavg)
cand.mods <- list("Climate" = M1a, "Geography" = M1b, "Genetic" = M1c)
selectionTable <- aictab(cand.set = cand.mods)
selectionTable
confset(cand.set = Cand.models)
confset(cand.set = cand.mods)
Y2 <- data.frame(stress.clim.ca$Individual, stress.clim.ca$PopID, stress.clim.ca$YII)
names(Y2) <- c("Individual", "PopID","YII")
Y2$Individual <- as.factor(Y2$Individual)
Y2b <- aggregate(YII ~ PopID,
data=Y2,
function(x) {
c(avg=var(x))
})
Y2b
Y2d.stress <- dist(Y2b, method="euclidean")
ngpop <- read.csv("NeiGpopdist.csv")
rownames(ngpop) <- ngpop$X
ngpop <- ngpop[,-1]
head(ngpop)
ngpop2 <- as.dist(ngpop)
ngpop <- read.csv("geneticeuclidpop.csv")
rownames(ngpop) <- ngpop$X
ngpop <- ngpop[,-1]
head(ngpop)
ngpop2 <- as.dist(ngpop)
dat3 <- dat2[-c(2,4,5,7,8,10:13,15,16,18:20,22:24,26,28:30,32,34:36,39,40,42,44:46,48,50:54),] #pops only
dat3 <- dat3[-c(12,14,18),]
head(dat3)
euclid.clim.subset=dist(dat3, method ="euclidean")
euclid.clim.subset
km.subset <- read.table("bpop_km_subset.txt")
names(km.subset) = gsub(pattern = "X", replacement = "", x = names(km.subset))
head(km.subset)
km.subset.d <- as.dist(km.subset)
dist.df2 <- data.frame( GenDist=ngpop2[lower.tri(ngpop2)], ClimDist=euclid.clim.subset[ lower.tri(euclid.clim.subset)], GeogDist = km.subset.d[lower.tri(km.subset.d)], Stress = Y2d.stress[lower.tri(Y2d.stress)])
M1a <-glm(Stress ~ ClimDist, data=dist.df2)
M1b <-glm(Stress ~ GeogDist, data=dist.df2)
M1c <-glm(Stress ~ GenDist, data=dist.df2)
M2a <-glm(Stress ~ GenDist + ClimDist, data=dist.df2)
M2b <-glm(Stress ~ GenDist + GeogDist, data=dist.df2)
M2c <-glm(Stress ~ ClimDist + GeogDist, data=dist.df2)
M3 <- glm(Stress ~ ClimDist + GeogDist + GenDist, data=dist.df2)
Dsquared(M1a);Dsquared(M1b);Dsquared(M1c)
Dsquared(M2a);Dsquared(M2b);Dsquared(M2c)
Dsquared(M3)
AIC(M1a);AIC(M1b);AIC(M1c)
AIC(M2a);AIC(M2b);AIC(M2c);AIC(M3)
Y2b
c(avg=mean(x))
#Y2a <- left_join(clusts, Y2, by=c("Individual","PopID"))
Y2b <- aggregate(YII ~ PopID,
data=Y2,
function(x) {
c(avg=mean(x))
})
Y2b
Y2 <- data.frame(stress.clim.ca$Individual, stress.clim.ca$PopID, stress.clim.ca$YII)
names(Y2) <- c("Individual", "PopID","YII")
Y2$Individual <- as.factor(Y2$Individual)
Y2b <- aggregate(YII ~ PopID,
data=Y2,
function(x) {
c(avg=var(x))
})
Y2b
Y2d.stress <- dist(Y2b, method="Bray-Curtis")
Y2d.stress <- dist(Y2b, method="Bray-Curtis")
dist(x)
dist(?)
?dist()
Y2d.stress <- dist(Y2b, method="minkowski")
dist.df2 <- data.frame( GenDist=ngpop2[lower.tri(ngpop2)], ClimDist=euclid.clim.subset[ lower.tri(euclid.clim.subset)], GeogDist = km.subset.d[lower.tri(km.subset.d)], Stress = Y2d.stress[lower.tri(Y2d.stress)])
M1a <- lm(Stress ~ ClimDist, data=dist.df2)
M1b <-lm(Stress ~ GeogDist, data=dist.df2)
M1c <-lm(Stress ~ GenDist, data=dist.df2)
AIC(M1a);AIC(M1b);AIC(M1c)
BIC(M1a);BIC(M1b);BIC(M1c)
library(AICcmodavg)
cand.mods <- list("Climate" = M1a, "Geography" = M1b, "Genetic" = M1c)
selectionTable <- aictab(cand.set = cand.mods)
selectionTable
confset(cand.set = cand.mods)
M1c <-glm(Stress ~ GenDist, data=dist.df2)
M1a <-glm(Stress ~ ClimDist, data=dist.df2)
M1b <-glm(Stress ~ GeogDist, data=dist.df2)
M1c <-glm(Stress ~ GenDist, data=dist.df2)
M2a <-glm(Stress ~ GenDist + ClimDist, data=dist.df2)
M2b <-glm(Stress ~ GenDist + GeogDist, data=dist.df2)
M2c <-glm(Stress ~ ClimDist + GeogDist, data=dist.df2)
M3 <- glm(Stress ~ ClimDist + GeogDist + GenDist, data=dist.df2)
Dsquared(M1a);Dsquared(M1b);Dsquared(M1c)
Dsquared(M2a);Dsquared(M2b);Dsquared(M2c)
Dsquared(M3)
AIC(M1a);AIC(M1b);AIC(M1c)
AIC(M2a);AIC(M2b);AIC(M2c);AIC(M3)
Y2d.stress <- dist(Y2b, method="canberra")
dist.df2 <- data.frame( GenDist=ngpop2[lower.tri(ngpop2)], ClimDist=euclid.clim.subset[ lower.tri(euclid.clim.subset)], GeogDist = km.subset.d[lower.tri(km.subset.d)], Stress = Y2d.stress[lower.tri(Y2d.stress)])
M1a <-glm(Stress ~ ClimDist, data=dist.df2)
M1b <-glm(Stress ~ GeogDist, data=dist.df2)
M1c <-glm(Stress ~ GenDist, data=dist.df2)
M2a <-glm(Stress ~ GenDist + ClimDist, data=dist.df2)
M2b <-glm(Stress ~ GenDist + GeogDist, data=dist.df2)
M2c <-glm(Stress ~ ClimDist + GeogDist, data=dist.df2)
M3 <- glm(Stress ~ ClimDist + GeogDist + GenDist, data=dist.df2)
Dsquared(M1a);Dsquared(M1b);Dsquared(M1c)
Dsquared(M2a);Dsquared(M2b);Dsquared(M2c)
Dsquared(M3)
AIC(M1a);AIC(M1b);AIC(M1c)
AIC(M2a);AIC(M2b);AIC(M2c);AIC(M3)
M1a <- lm(Stress ~ ClimDist, data=dist.df2)
M1b <-lm(Stress ~ GeogDist, data=dist.df2)
M1c <-lm(Stress ~ GenDist, data=dist.df2)
AIC(M1a);AIC(M1b);AIC(M1c)
Y2d.stress <- sqrt(Y2d.stress)
Y2d.stress <- dist(Y2b, method="euclidean")
Y2d.stress <- sqrt(Y2d.stress)
dist.df2 <- data.frame( GenDist=ngpop2[lower.tri(ngpop2)], ClimDist=euclid.clim.subset[ lower.tri(euclid.clim.subset)], GeogDist = km.subset.d[lower.tri(km.subset.d)], Stress = Y2d.stress[lower.tri(Y2d.stress)])
M1a <-glm(Stress ~ ClimDist, data=dist.df2)
M1b <-glm(Stress ~ GeogDist, data=dist.df2)
M1c <-glm(Stress ~ GenDist, data=dist.df2)
M2a <-glm(Stress ~ GenDist + ClimDist, data=dist.df2)
M2b <-glm(Stress ~ GenDist + GeogDist, data=dist.df2)
M2c <-glm(Stress ~ ClimDist + GeogDist, data=dist.df2)
M3 <- glm(Stress ~ ClimDist + GeogDist + GenDist, data=dist.df2)
Dsquared(M1a);Dsquared(M1b);Dsquared(M1c)
Dsquared(M2a);Dsquared(M2b);Dsquared(M2c)
Dsquared(M3)
AIC(M1a);AIC(M1b);AIC(M1c)
AIC(M2a);AIC(M2b);AIC(M2c);AIC(M3)
M1a <- lm(Stress ~ ClimDist, data=dist.df2)
M1b <-lm(Stress ~ GeogDist, data=dist.df2)
M1c <-lm(Stress ~ GenDist, data=dist.df2)
AIC(M1a);AIC(M1b);AIC(M1c)
BIC(M1a);BIC(M1b);BIC(M1c)
shapiro.test(dat3)
shapiro.test(Y2b)
shapiro.test(Y2d.stress)
hist(Y2d.stress)
c(avg=var(x))
#Y2a <- left_join(clusts, Y2, by=c("Individual","PopID"))
Y2b <- aggregate(YII ~ PopID,
data=Y2,
function(x) {
c(avg=var(x))
})
Y2b
Y2d <- dist(Y2, method="euclidean")
shapiro.test(Y2d)
Y2d.stress <- dist(Y2, method="euclidean")
shapiro.test(Y2d.stress)
hist(shapiro.test)
Y2 <- data.frame(recovery.clim.ca$Individual, recovery.clim.ca$PopID, recovery.clim.ca$YII)
names(Y2) <- c("Individual", "PopID","YII")
Y2$Individual <- as.factor(Y2$Individual)
#Y2a <- left_join(clusts, Y2, by=c("Individual","PopID"))
Y2b <- aggregate(YII ~ PopID,
data=Y2,
function(x) {
c(avg=var(x))
})
Y2b
Y2d.stress <- dist(Y2b, method="euclidean")
shapiro.test(Y2d.stress)
hist(shapiro.test)
hist(Y2d.stress)
hist(log(Y2d.stress))
hist(sqrt(Y2d.stress))
Y2 <- data.frame(stress.clim.ca$Individual, stress.clim.ca$PopID, stress.clim.ca$YII)
names(Y2) <- c("Individual", "PopID","YII")
Y2$Individual <- as.factor(Y2$Individual)
Y2b <- aggregate(YII ~ PopID,
data=Y2,
function(x) {
c(avg=var(x))
})
Y2b
Y2d.stress <- dist(Y2b, method="euclidean")
shapiro.test(Y2d.stress)
Y2 <- data.frame(stress.clim.ca$Individual, stress.clim.ca$PopID, stress.clim.ca$YII)
names(Y2) <- c("Individual", "PopID","YII")
Y2$Individual <- as.factor(Y2$Individual)
Y2b <- aggregate(YII ~ PopID,
data=Y2,
function(x) {
c(avg=var(x))
})
Y2b
#?dist()
Y2d.stress <- dist(Y2b, method="euclidean")
shapiro.test(Y2d.stress)
hist(Y2d.stress)
Y2d.stress <- sqrt(Y2d.stress)
hist(Y2d.stress)
dist.df2 <- data.frame( GenDist=ngpop2[lower.tri(ngpop2)], ClimDist=euclid.clim.subset[ lower.tri(euclid.clim.subset)], GeogDist = km.subset.d[lower.tri(km.subset.d)], Stress = Y2d.stress[lower.tri(Y2d.stress)])
M1a <-glm(Stress ~ ClimDist, data=dist.df2)
M1b <-glm(Stress ~ GeogDist, data=dist.df2)
M1c <-glm(Stress ~ GenDist, data=dist.df2)
M2a <-glm(Stress ~ GenDist + ClimDist, data=dist.df2)
M2b <-glm(Stress ~ GenDist + GeogDist, data=dist.df2)
M2c <-glm(Stress ~ ClimDist + GeogDist, data=dist.df2)
M3 <- glm(Stress ~ ClimDist + GeogDist + GenDist, data=dist.df2)
Dsquared(M1a);Dsquared(M1b);Dsquared(M1c)
Dsquared(M2a);Dsquared(M2b);Dsquared(M2c)
Dsquared(M3)
AIC(M1a);AIC(M1b);AIC(M1c)
AIC(M2a);AIC(M2b);AIC(M2c);AIC(M3)
M1a <- lm(Stress ~ ClimDist, data=dist.df2)
M1b <-lm(Stress ~ GeogDist, data=dist.df2)
M1c <-lm(Stress ~ GenDist, data=dist.df2)
AIC(M1a);AIC(M1b);AIC(M1c)
BIC(M1a);BIC(M1b);BIC(M1c)
library(AICcmodavg)
cand.mods <- list("Climate" = M1a, "Geography" = M1b, "Genetic" = M1c)
selectionTable <- aictab(cand.set = cand.mods)
selectionTable
confset(cand.set = cand.mods)
Y2 <- data.frame(recovery.clim.ca$Individual, recovery.clim.ca$PopID, recovery.clim.ca$YII)
names(Y2) <- c("Individual", "PopID","YII")
Y2$Individual <- as.factor(Y2$Individual)
#Y2a <- left_join(clusts, Y2, by=c("Individual","PopID"))
Y2b <- aggregate(YII ~ PopID,
data=Y2,
function(x) {
c(avg=var(x))
})
Y2b
Y2d.stress <- dist(Y2b, method="euclidean")
shapiro.test(Y2d.stress)
hist(Y2d.stress)
hist(sqrt(Y2d.stress))
Y2d.stress <- sqrt(Y2d.stress)
ngpop <- read.csv("NeiGpopdist.csv")
rownames(ngpop) <- ngpop$X
ngpop <- ngpop[,-1]
head(ngpop)
ngpop2 <- as.dist(ngpop)
dat3 <- dat2[-c(2,4,5,7,8,10:13,15,16,18:20,22:24,26,28:30,32,34:36,39,40,42,44:46,48,50:54),] #pops only
dat3 <- dat3[-c(12,14,18),]
head(dat3)
euclid.clim.subset=dist(dat3, method ="euclidean")
euclid.clim.subset
km.subset <- read.table("bpop_km_subset.txt")
names(km.subset) = gsub(pattern = "X", replacement = "", x = names(km.subset))
head(km.subset)
km.subset.d <- as.dist(km.subset)
dist.df2 <- data.frame( GenDist=ngpop2[lower.tri(ngpop2)], ClimDist=euclid.clim.subset[ lower.tri(euclid.clim.subset)], GeogDist = km.subset.d[lower.tri(km.subset.d)], Stress = Y2d.stress[lower.tri(Y2d.stress)])
M1a <- lm(Stress ~ ClimDist, data=dist.df2)
M1b <-lm(Stress ~ GeogDist, data=dist.df2)
M1c <-lm(Stress ~ GenDist, data=dist.df2)
AIC(M1a);AIC(M1b);AIC(M1c)
BIC(M1a);BIC(M1b);BIC(M1c)
library(AICcmodavg)
cand.mods <- list("Climate" = M1a, "Geography" = M1b, "Genetic" = M1c)
selectionTable <- aictab(cand.set = cand.mods)
selectionTable
confset(cand.set = cand.mods)
M1a <-glm(Stress ~ ClimDist, data=dist.df2)
M1b <-glm(Stress ~ GeogDist, data=dist.df2)
M1c <-glm(Stress ~ GenDist, data=dist.df2)
AIC(M1a);AIC(M1b);AIC(M1c)
ngpop <- read.csv("geneticeuclidpop.csv")
rownames(ngpop) <- ngpop$X
ngpop <- ngpop[,-1]
head(ngpop)
ngpop2 <- as.dist(ngpop)
dist.df2 <- data.frame( GenDist=ngpop2[lower.tri(ngpop2)], ClimDist=euclid.clim.subset[ lower.tri(euclid.clim.subset)], GeogDist = km.subset.d[lower.tri(km.subset.d)], Stress = Y2d.stress[lower.tri(Y2d.stress)])
M1a <-glm(Stress ~ ClimDist, data=dist.df2)
M1b <-glm(Stress ~ GeogDist, data=dist.df2)
M1c <-glm(Stress ~ GenDist, data=dist.df2)
AIC(M1a);AIC(M1b);AIC(M1c)
AIC(M1a);AIC(M1b);AIC(M1c)
ngpop <- read.csv("Rhopopdist.csv")
rownames(ngpop) <- ngpop$X
ngpop <- ngpop[,-1]
head(ngpop)
ngpop2 <- as.dist(ngpop)
M1a <-glm(Stress ~ ClimDist, data=dist.df2)
M1b <-glm(Stress ~ GeogDist, data=dist.df2)
M1c <-glm(Stress ~ GenDist, data=dist.df2)
AIC(M1a);AIC(M1b);AIC(M1c)
Y2 <- data.frame(stress.clim.ca$Individual, stress.clim.ca$PopID, stress.clim.ca$YII)
names(Y2) <- c("Individual", "PopID","YII")
Y2$Individual <- as.factor(Y2$Individual)
Y2b <- aggregate(YII ~ PopID,
data=Y2,
function(x) {
c(avg=var(x))
})
Y2b
#?dist()
Y2d.stress <- dist(Y2b, method="euclidean")
shapiro.test(Y2d.stress)
hist(Y2d.stress)
Y2d.stress <- sqrt(Y2d.stress)
hist(Y2d.stress)
dist.df2 <- data.frame( GenDist=ngpop2[lower.tri(ngpop2)], ClimDist=euclid.clim.subset[ lower.tri(euclid.clim.subset)], GeogDist = km.subset.d[lower.tri(km.subset.d)], Stress = Y2d.stress[lower.tri(Y2d.stress)])
M1a <- lm(Stress ~ ClimDist, data=dist.df2)
M1b <-lm(Stress ~ GeogDist, data=dist.df2)
M1c <-lm(Stress ~ GenDist, data=dist.df2)
AIC(M1a);AIC(M1b);AIC(M1c)
BIC(M1a);BIC(M1b);BIC(M1c)
library(AICcmodavg)
cand.mods <- list("Climate" = M1a, "Geography" = M1b, "Genetic" = M1c)
selectionTable <- aictab(cand.set = cand.mods)
selectionTable
confset(cand.set = cand.mods)
M1a <-glm(Stress ~ ClimDist, data=dist.df2)
M1b <-glm(Stress ~ GeogDist, data=dist.df2)
M1c <-glm(Stress ~ GenDist, data=dist.df2)
Dsquared(M1a);Dsquared(M1b);Dsquared(M1c)
AIC(M1a);AIC(M1b);AIC(M1c)
class(bruv2)
bruv3 <- as.data.frame(bruv2)
bruv3 <- as.data.frame(matrix(bruv2))
head(bruv3)
View(bruv3)
devtools::install_github("vmikk/metagMisc")
library("metagMisc")
devtools::install_github("vmikk/metagMisc")
library("metagMisc")
devtools::install_github("vmikk/metagMisc")
library("metagMisc")
bruv2
View(bruv)
View(bruv)
bruv3 <- rbind(bruv[1:2,3:5])
View(bruv3)
bruv3 <- rbind(bruv[1:2,3:5,6:8,9:13,14:16,17:20,21:24,25:26,27:30,31:32,33:36,37,38:40,41:42,43:46,47:48,49:53,54:55])
bruv3 <- rbind(bruv[1:2,3:5,6:8,9:13,14:16,17:20,21:24,25:26,27:30,31:32,33:36,38:40,41:42,43:46,47:48,49:53,54:55])
bruv3 <- cbind(bruv[1:2,3:5,6:8,9:13,14:16,17:20,21:24,25:26,27:30,31:32,33:36,38:40,41:42,43:46,47:48,49:53,54:55])
bruv3 <- rbind(bruv[1:2])
View(bruv3)
View(bruv)
bruv3 <- dist.merge(bruv, (list(c(1,3),c(2,2))), aggregate=mean, FUN.VALUE= +Inf)
bruv3 <- tibble::rownames_to_column(bruv, "Pop")
View(bruv3)
bruv$Pop <- as.integer(bruv$Pop)
bruv3 %>%
convert(int(Pop))
bruv3 %>%
convert(int(Pop))
library(tibble)
library(hablar)
install.packages(hablar)
install.packages('hablar')
bruv3$Pop <- as.integer(bruv3$Pop)
View(bruv3)
bruv3$Pop <- as.character(bruv3$Pop)
View(bruv3)
View(bruv3)
View(bruv3)
View(bruv3)
obj1 <- read.structure("Msat_ca_triploid_missingalleles", n.ind=55, n.loc=13, row.marknames=1)
AICc(obj1, 3, pop.ini = "ward",
max.iter = 100,
n.start = 10,
n.start.kmeans = 50,
hybrids = FALSE,
dim.ini = 100,
hybrid.coef = NULL,
)
obj1 <- read.structure("Msat_ca_triploid_missingalleles", n.ind=55, n.loc=13, row.marknames=1)
gendf1<- read.csv("msatdf_trip_missingmarkers.csv")
rownames(gendf1) <- gendf1[,1]; gendf1 <- gendf1[,-c(1)]
gendf2 <- t(gendf1)
obj1 <- df2genind(gendf1, sep=",", ncode=3, NA.char=0, ploidy=3, type='codom')
obj1
AICc(obj1, 3, pop.ini = "ward",
max.iter = 100,
n.start = 10,
n.start.kmeans = 50,
hybrids = FALSE,
dim.ini = 100,
hybrid.coef = NULL,
)
a.clust <- snapclust(obj1, k = 2)
install.packages("fastbaps")
devtools::install_github("gtonkinhill/fastbaps")
library(fastbaps)
library(ape)
find.clusters.genind(obj1)
M1a <- lm(Stress ~ ClimDist, data=dist.df2)
M1b <-lm(Stress ~ GeogDist, data=dist.df2)
M1c <-lm(Stress ~ GenDist, data=dist.df2)
AIC(M1a);AIC(M1b);AIC(M1c)
selectionTable <- aictab(cand.set = cand.mods)
selectionTable
